"use strict";(self.webpackChunkvisitorsys=self.webpackChunkvisitorsys||[]).push([[23],{2023:(L,g,a)=>{a.r(g),a.d(g,{LoginComponent:()=>U});var c=a(6814),s=a(95),e=a(4946);class u extends Error{}u.prototype.name="InvalidTokenError";var h=a(553),_=a(9862);let v=(()=>{class t{constructor(n){this._HttpClient=n,this.baseUrl=`${h.T.apiUrl}Login`}login(n){return this._HttpClient.post(`${this.baseUrl}`,n)}decodeUser(){const n=localStorage.getItem("etoken");if(null!==n){const o=function f(t,i){if("string"!=typeof t)throw new u("Invalid token specified: must be a string");i||(i={});const n=!0===i.header?0:1,o=t.split(".")[n];if("string"!=typeof o)throw new u(`Invalid token specified: missing part #${n+1}`);let r;try{r=function d(t){let i=t.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function p(t){return decodeURIComponent(atob(t).replace(/(.)/g,(i,n)=>{let o=n.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}(i)}catch{return atob(i)}}(o)}catch(l){throw new u(`Invalid token specified: invalid base64 for part #${n+1} (${l.message})`)}try{return JSON.parse(r)}catch(l){throw new u(`Invalid token specified: invalid json for part #${n+1} (${l.message})`)}}(n);this.userInfo=o,console.log(this.userInfo)}}static#e=this.\u0275fac=function(o){return new(o||t)(e.LFG(_.eN))};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var Z=a(4670);function b(t,i){1&t&&(e.TgZ(0,"p",19),e._uU(1,"username is Required"),e.qZA())}function x(t,i){1&t&&(e.TgZ(0,"p",19),e._uU(1,"username InValid Format"),e.qZA())}function w(t,i){if(1&t&&(e.TgZ(0,"div",17),e.YNc(1,b,2,0,"p",18),e.YNc(2,x,2,0,"p",18),e.qZA()),2&t){const n=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=n.loginForm.get("username"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=n.loginForm.get("username"))?null:r.getError("username"))}}function I(t,i){1&t&&(e.TgZ(0,"p",19),e._uU(1,"password is Required"),e.qZA())}function T(t,i){1&t&&(e.TgZ(0,"p",19),e._uU(1,"must be at least 6 Chars"),e.qZA())}function F(t,i){if(1&t&&(e.TgZ(0,"div",17),e.YNc(1,I,2,0,"p",18),e.YNc(2,T,2,0,"p",18),e.qZA()),2&t){const n=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=n.loginForm.get("password"))?null:o.getError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=n.loginForm.get("password"))?null:r.getError("pattern"))}}function C(t,i){1&t&&(e.TgZ(0,"span"),e._UZ(1,"i",20),e.qZA())}function A(t,i){if(1&t&&(e.TgZ(0,"p",21),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(n.errMsg)}}let U=(()=>{class t{constructor(n,o,r){this._AuthService=n,this._Router=o,this._FormBuilder=r,this.errMsg="",this.isLoading=!1,this.loginForm=this._FormBuilder.group({username:["",[s.kI.required]],password:["",[s.kI.required]]})}handleForm(){const n=this.loginForm.value;console.log(n),this.isLoading=!0,!0===this.loginForm.valid&&this._AuthService.login(n).subscribe({next:o=>{console.log(o),localStorage.setItem("etoken",o.tokenValue),this._AuthService.decodeUser(),this._Router.navigate(["/home"]),this.isLoading=!1},error:o=>{console.log(o),this.errMsg=o.error.message,this.isLoading=!1}})}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(v),e.Y36(Z.F0),e.Y36(s.qu))};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],standalone:!0,features:[e.jDz],decls:24,vars:6,consts:[[1,"col-12","d-flex","align-items-center","justify-content-center"],[1,"w-50","mx-auto","shadow","rounded","p-4","my-3","bg-main-light","card","border-grey","border-lighten-3","m-0"],[1,"m-0"],[1,"p-1","text-center"],["src","./assets/image/logo_In.png","alt","logo",1,"w-25"],[1,"card-subtitle","line-on-side","text-muted","text-center","font-small-3","pt-2"],[3,"formGroup","submit"],[1,"form-item"],["for","name",1,"mb-2"],["formControlName","username","type","text","id","name",1,"form-control","mb-3"],["class","alert alert-danger p-1 small w-50 mx-auto",4,"ngIf"],["for","password",1,"mb-2"],["formControlName","password","type","password","id","password",1,"form-control","mb-3"],[1,"d-flex","justify-content-center","align-items-center"],[1,"btn","btn-primary","main-btn","mt-2","w-50",3,"disabled"],[4,"ngIf"],["class","alert alert-danger p-1 w-50 mx-auto mb-0 text-center",4,"ngIf"],[1,"alert","alert-danger","p-1","small","w-50","mx-auto"],["class","mb-0",4,"ngIf"],[1,"mb-0"],[1,"fas","fa-spin","fa-spinner"],[1,"alert","alert-danger","p-1","w-50","mx-auto","mb-0","text-center"]],template:function(o,r){if(1&o&&(e.TgZ(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3),e._UZ(4,"img",4),e.qZA()(),e.TgZ(5,"h6",5)(6,"h1"),e._uU(7,"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644"),e.qZA()(),e.TgZ(8,"form",6),e.NdJ("submit",function(){return r.handleForm()}),e.TgZ(9,"div",7)(10,"label",8),e._uU(11,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.qZA(),e._UZ(12,"input",9),e.YNc(13,w,3,2,"div",10),e.qZA(),e.TgZ(14,"div",7)(15,"label",11),e._uU(16,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"),e.qZA(),e._UZ(17,"input",12),e.YNc(18,F,3,2,"div",10),e.qZA(),e.TgZ(19,"div",13)(20,"button",14),e._uU(21,"Login "),e.YNc(22,C,2,0,"span",15),e.qZA()()(),e.YNc(23,A,2,1,"p",16),e.qZA()()),2&o){let l,m;e.xp6(8),e.Q6J("formGroup",r.loginForm),e.xp6(5),e.Q6J("ngIf",(null==(l=r.loginForm.get("username"))?null:l.errors)&&(null==(l=r.loginForm.get("username"))?null:l.touched)),e.xp6(5),e.Q6J("ngIf",(null==(m=r.loginForm.get("password"))?null:m.errors)&&(null==(m=r.loginForm.get("password"))?null:m.touched)),e.xp6(2),e.Q6J("disabled",r.loginForm.invalid),e.xp6(2),e.Q6J("ngIf",r.isLoading),e.xp6(1),e.Q6J("ngIf",r.errMsg)}},dependencies:[c.ez,c.O5,s.UX,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u]})}return t})()}}]);